<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RVM Basit Bakım Paneli</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #030712; /* gray-950 */
        }
        /* Bakım Modu Toggle */
        #maintenance-toggle:checked ~ .dot {
            transform: translateX(100%);
            background-color: #22c55e; /* green-500 */
        }
        #maintenance-toggle:checked ~ .block {
            background-color: #16a34a; /* green-600 */
        }
        .status-dot {
            height: 10px;
            width: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        .status-iyi { background-color: #22c55e; box-shadow: 0 0 6px #22c55e; } /* green-500 */
        .status-uyari { background-color: #f59e0b; box-shadow: 0 0 6px #f59e0b; } /* amber-500 */
        .status-hata { background-color: #ef4444; box-shadow: 0 0 6px #ef4444; } /* red-500 */

        .card {
            background-color: #111827; /* gray-900 */
            border: 1px solid #1f2937; /* gray-800 */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.15);
        }
        .lock-icon {
            transition: all 0.3s ease-in-out;
        }
        .lock-icon.unlocked .lock-body {
             transform: translateY(2px);
        }
        .lock-icon.unlocked .lock-shackle {
            transform: translateY(-8px) rotate(-15deg);
        }
    </style>
</head>
<body class="text-gray-200">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        <!-- Başlık -->
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-white">RVM Basit Bakım Paneli</h1>
            <p class="text-gray-400 mt-2">Temel sistem verileri ve kilit kontrolleri</p>
        </header>

        <!-- Bakım Modu Toggle -->
        <section class="flex justify-center items-center mb-12">
            <label for="maintenance-toggle" class="flex items-center cursor-pointer">
                <span class="mr-4 text-lg font-semibold text-white">Bakım Modu</span>
                <div class="relative">
                    <input type="checkbox" id="maintenance-toggle" class="sr-only">
                    <div class="block bg-gray-600 w-14 h-8 rounded-full"></div>
                    <div class="dot absolute left-1 top-1 bg-white w-6 h-6 rounded-full transition-transform duration-300 ease-in-out"></div>
                </div>
                <span id="maintenance-status" class="ml-4 text-lg font-bold text-red-400 w-16">PASİF</span>
            </label>
        </section>

        <main class="space-y-12">
            <!-- Kilit Kontrolleri Bölümü -->
            <section id="kilit-kontrolleri">
                <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-700 pb-3 text-cyan-400">Kilit Kontrolleri</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-8">
                    <!-- Üst Kapak Kilidi -->
                    <div class="card p-6 rounded-2xl flex flex-col items-center">
                        <h3 class="text-xl font-semibold mb-4 text-white">Üst Kapak Kilidi</h3>
                        <div class="mb-6">
                            <svg id="top-lock-icon" class="lock-icon w-20 h-20 text-gray-400" viewBox="0 -10 24 34" fill="none" stroke="currentColor" stroke-width="1.5">
                                <g class="lock-shackle" style="transform-origin: 12px 10px;">
                                  <path d="M16 10H8C6.34315 10 5 8.65685 5 7V6C5 4.34315 6.34315 3 8 3H16C17.6569 3 19 4.34315 19 6V7C19 8.65685 17.6569 10 16 10Z" stroke="currentColor"/>
                                </g>
                                <g class="lock-body">
                                  <rect x="4" y="10" width="16" height="11" rx="2" fill="currentColor"/>
                                </g>
                            </svg>
                        </div>
                        <div class="w-full flex gap-4">
                            <button onclick="toggleLock('top', false)" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300">Kilit Aç</button>
                            <button onclick="toggleLock('top', true)" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300">Kilit Kapat</button>
                        </div>
                    </div>
                    <!-- Alt Kapak Kilidi -->
                    <div class="card p-6 rounded-2xl flex flex-col items-center">
                        <h3 class="text-xl font-semibold mb-4 text-white">Alt Kapak Kilidi</h3>
                        <div class="mb-6">
                             <svg id="bottom-lock-icon" class="lock-icon w-20 h-20 text-gray-400" viewBox="0 -10 24 34" fill="none" stroke="currentColor" stroke-width="1.5">
                                <g class="lock-shackle" style="transform-origin: 12px 10px;">
                                  <path d="M16 10H8C6.34315 10 5 8.65685 5 7V6C5 4.34315 6.34315 3 8 3H16C17.6569 3 19 4.34315 19 6V7C19 8.65685 17.6569 10 16 10Z" stroke="currentColor"/>
                                </g>
                                <g class="lock-body">
                                  <rect x="4" y="10" width="16" height="11" rx="2" fill="currentColor"/>
                                </g>
                            </svg>
                        </div>
                        <div class="w-full flex gap-4">
                            <button onclick="toggleLock('bottom', false)" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300">Kilit Aç</button>
                            <button onclick="toggleLock('bottom', true)" class="w-full bg-red-600 hover:bg-red-700 text-white font-bold py-3 px-4 rounded-lg transition duration-300">Kilit Kapat</button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sensör Durumları Bölümü -->
            <section id="sensör-durumları">
                <h2 class="text-2xl font-semibold mb-6 border-b-2 border-gray-700 pb-3 text-cyan-400">Sensör Durumları</h2>
                <div id="sensor-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 gap-6">
                    <!-- Sensör kartları buraya JS ile eklenecek -->
                </div>
            </section>
        </main>
    </div>

    <script>
        const sensors = [
            { id: 'giris-sensoru', name: 'Giriş Sensörü', type: 'standard' },
            { id: 'konveyor-led', name: 'Konveyör LED', type: 'standard' },
            { id: 'plastik-hazne', name: 'Plastik Hazne', type: 'standard' },
            { id: 'metal-hazne', name: 'Metal Hazne', type: 'standard' },
            { id: 'cam-hazne', name: 'Cam Hazne', type: 'standard' },
            { id: 'yonlendirici-opt-sensor', name: 'Yönlendirici Sensör', type: 'standard' },
            { id: 'yonlendirici-induktif', name: 'Yönlendirici İndüktif', type: 'standard' },
            { id: 'klape-induktif', name: 'Klape İndüktif', type: 'standard' },
            { id: 'ust-kapak-kilit-sensor', name: 'Üst Kapak Kilit Sensörü', type: 'standard' },
            { id: 'alt-kapak-kilit-sensor', name: 'Alt Kapak Kilit Sensörü', type: 'standard' },
            { id: 'ust-kapak-emniyet', name: 'Üst Kapak Emniyet', type: 'standard' },
            { id: 'alt-kapak-emniyet', name: 'Alt Kapak Emniyet', type: 'standard' },
            { id: 'ac-ezici-motor', name: 'AC Ezici Motor', type: 'ac_motor' },
            { id: 'ac-kirici-motor', name: 'AC Kırıcı Motor', type: 'ac_motor' }
        ];

        const healthStates = [
            { text: 'İyi', className: 'status-iyi', textColor: 'text-green-400' },
            { text: 'Uyarı', className: 'status-uyari', textColor: 'text-yellow-400' },
            { text: 'Hata', className: 'status-hata', textColor: 'text-red-400' }
        ];
        
        function createAcMotorCard(sensor) {
            return `
                <div id="${sensor.id}" class="sensor-card card p-4 rounded-2xl flex flex-col space-y-3">
                    <h4 class="text-lg font-semibold text-center text-white">${sensor.name}</h4>
                    <div class="text-xs space-y-1 text-gray-300 pt-2 border-t border-gray-700">
                        <div class="flex justify-between"><span>Verilen Frekans:</span><span class="font-mono font-semibold" data-type="set-freq">50.0 Hz</span></div>
                        <div class="flex justify-between"><span>Çıkış Frekansı:</span><span class="font-mono font-semibold" data-type="out-freq">-- Hz</span></div>
                        <div class="flex justify-between"><span>Voltaj:</span><span class="font-mono font-semibold" data-type="voltage">-- V</span></div>
                        <div class="flex justify-between"><span>Akım:</span><span class="font-mono font-semibold" data-type="current">-- A</span></div>
                        <div class="flex justify-between"><span>Güç:</span><span class="font-mono font-semibold" data-type="power">-- W</span></div>
                        <div class="flex justify-between"><span>Bus Voltajı:</span><span class="font-mono font-semibold" data-type="bus-voltage">-- V</span></div>
                        <div class="flex justify-between"><span>Sıcaklık:</span><span class="font-mono font-semibold" data-type="temp">-- °C</span></div>
                        <div class="flex justify-between"><span>Çalışma Yönü:</span><span class="font-semibold" data-type="direction">Duruyor</span></div>
                        <div class="flex justify-between"><span>Çalışma Durumu:</span><span class="font-semibold" data-type="status">Çalışmıyor</span></div>
                        <div class="flex justify-between"><span>Hazır Mı:</span><span class="font-semibold text-green-400" data-type="ready">Evet</span></div>
                        <div class="flex justify-between"><span>Arıza Var Mı:</span><span class="font-semibold text-green-400" data-type="fault">Yok</span></div>
                    </div>
                </div>
            `;
        }

        function createStandardSensorCard(sensor) {
            const health = healthStates[0];
            return `
                <div id="${sensor.id}" class="sensor-card card p-4 rounded-2xl flex flex-col space-y-3">
                    <h4 class="text-lg font-semibold text-center text-white">${sensor.name}</h4>
                    <div class="text-sm space-y-2 text-gray-300 pt-2 border-t border-gray-700">
                        <div class="flex justify-between items-center"><span>Bus Voltajı:</span><span class="data-value font-mono font-semibold" data-type="voltage">-- V</span></div>
                        <div class="flex justify-between items-center"><span>Şönt Voltajı:</span><span class="data-value font-mono font-semibold" data-type="shunt">-- mV</span></div>
                        <div class="flex justify-between items-center"><span>Akım:</span><span class="data-value font-mono font-semibold" data-type="current">-- mA</span></div>
                        <div class="flex justify-between items-center"><span>Güç:</span><span class="data-value font-mono font-semibold" data-type="power">-- W</span></div>
                        <div class="flex justify-between items-center">
                            <span>Sağlık Durumu:</span>
                            <span class="health-status flex items-center gap-2 font-semibold ${health.textColor}">
                                <span class="status-dot ${health.className}"></span>
                                <span>${health.text}</span>
                            </span>
                        </div>
                    </div>
                </div>
            `;
        }

        function createSensorCard(sensor) {
            if (sensor.type === 'ac_motor') {
                return createAcMotorCard(sensor);
            }
            return createStandardSensorCard(sensor);
        }

        function updateSensorData() {
            document.querySelectorAll('.sensor-card').forEach(card => {
                const id = card.id;

                if (id.includes('ac-ezici') || id.includes('ac-kirici')) {
                    card.querySelector('[data-type="out-freq"]').textContent = `${(Math.random() * 2).toFixed(1)} Hz`;
                    card.querySelector('[data-type="voltage"]').textContent = `${(Math.random() * 5).toFixed(1)} V`;
                    card.querySelector('[data-type="current"]').textContent = `${(Math.random() * 0.2).toFixed(1)} A`;
                    card.querySelector('[data-type="power"]').textContent = `${(Math.random() * 10).toFixed(1)} W`;
                    card.querySelector('[data-type="bus-voltage"]').textContent = `${(310 + (Math.random() - 0.5) * 4).toFixed(1)} V`;
                    card.querySelector('[data-type="temp"]').textContent = `${(35 + Math.random() * 3).toFixed(1)} °C`;
                } else {
                     // Değerleri rastgele güncelle
                    card.querySelector('[data-type="voltage"]').textContent = `${(24 + (Math.random() - 0.5)).toFixed(1)} V`;
                    card.querySelector('[data-type="shunt"]').textContent = `${(30 + (Math.random() - 0.5) * 10).toFixed(1)} mV`;
                    card.querySelector('[data-type="current"]').textContent = `${(15 + (Math.random() - 0.5) * 5).toFixed(0)} mA`;
                    card.querySelector('[data-type="power"]').textContent = `${(0.4 + (Math.random() - 0.5) * 0.2).toFixed(2)} W`;

                    // Sağlık durumunu rastgele değiştirme ihtimali
                    if (Math.random() < 0.02) { // %2 ihtimalle durum değişir
                        const newHealth = healthStates[Math.floor(Math.random() * healthStates.length)];
                        const healthStatusSpan = card.querySelector('.health-status');
                        const dot = healthStatusSpan.querySelector('.status-dot');
                        const text = healthStatusSpan.querySelector('span:last-child');

                        healthStatusSpan.className = `health-status flex items-center gap-2 font-semibold ${newHealth.textColor}`;
                        dot.className = `status-dot ${newHealth.className}`;
                        text.textContent = newHealth.text;
                    }
                }
            });
        }

        function toggleLock(lockId, isLocked) {
            const icon = document.getElementById(`${lockId}-lock-icon`);
            if (isLocked) {
                icon.classList.remove('unlocked');
                icon.classList.remove('text-green-400');
                icon.classList.add('text-gray-400');
            } else {
                icon.classList.add('unlocked');
                icon.classList.remove('text-gray-400');
                icon.classList.add('text-green-400');
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            const sensorGrid = document.getElementById('sensor-grid');
            sensors.forEach(sensor => {
                sensorGrid.innerHTML += createSensorCard(sensor);
            });

            // Bakım Modu Kontrolü
            const maintenanceToggle = document.getElementById('maintenance-toggle');
            const maintenanceStatus = document.getElementById('maintenance-status');
            const controlButtons = document.querySelectorAll('#kilit-kontrolleri button');
            const sensorGridContainer = document.getElementById('sensor-grid');
            let sensorUpdateInterval = null;

            function setMaintenanceMode(isActive) {
                if (isActive) { // AKTİF -> Her şey AÇIK/ETKİN
                    maintenanceStatus.textContent = 'AKTİF';
                    maintenanceStatus.classList.remove('text-red-400');
                    maintenanceStatus.classList.add('text-green-400');
                    controlButtons.forEach(button => button.disabled = false);
                    sensorGridContainer.style.opacity = '1';
                    sensorGridContainer.style.pointerEvents = 'auto';

                    // Sensör verisi güncellemeyi başlat
                    if (!sensorUpdateInterval) {
                        updateSensorData(); // Moda girince hemen güncelle
                        sensorUpdateInterval = setInterval(updateSensorData, 2000);
                    }

                } else { // PASİF -> Her şey KAPALI/DEVRE DIŞI
                    maintenanceStatus.textContent = 'PASİF';
                    maintenanceStatus.classList.remove('text-green-400');
                    maintenanceStatus.classList.add('text-red-400');
                    controlButtons.forEach(button => button.disabled = true);
                    sensorGridContainer.style.opacity = '0.5';
                    sensorGridContainer.style.pointerEvents = 'none';

                    // Sensör verisi güncellemeyi durdur
                    if (sensorUpdateInterval) {
                        clearInterval(sensorUpdateInterval);
                        sensorUpdateInterval = null;
                    }
                }
            }

            maintenanceToggle.addEventListener('change', (e) => {
                setMaintenanceMode(e.target.checked);
            });

            // Başlangıçta kilitleri kapalı ayarla
            toggleLock('top', true);
            toggleLock('bottom', true);

            // Başlangıçta bakım modunu pasif yap ve kontrolleri devre dışı bırak
            setMaintenanceMode(false);
        });

    </script>

</body>
</html>

